var P2=function(t){var e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=7)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),a=i(4),n=i(1),r=i(6),h=i(9);class o{constructor(t,e){this._id=Symbol(),this._type=e,this._show=!0,this._tag=t&&t.tag?t.tag:"",this._zIndex=t&&t.zIndex?t.zIndex:0,this._mounted=t&&t.mounted?t.mounted:()=>{},this._removed=t&&t.removed?t.removed:()=>{},this.isMount=!1,this.count=1}initSetter(){h.default[this._type].writableProperties.map(t=>{let e=t.substring(0,1).toUpperCase()+t.substring(1);void 0===this[`setter${e}`]&&(this[`setter${e}`]=function(e){this[`_${t}`]=e,h.default[this._type].notRePathProperties.includes(t)||this.drawPath().rotatePath().transFormPath()})})}attr(t,e){return h.default[this._type].readableProperties.includes(t)?void 0!==e?(h.default[this._type].writableProperties.includes(t)?(this[`setter${t.substring(0,1).toUpperCase()+t.substring(1)}`](e),this.isMount&&n.default.notify("update",this._zIndex)):console.warn(`${t}不能被修改`),this):this[`_${t}`]:(console.warn(`${t}属性不存在`),this)}toggleMount(t){this.isMount=t,t?this.mounted():this.removed(),"Group"!==this._type&&"Composite"!==this._type||this.getShapeList().map(e=>{e.toggleMount(t)})}getCount(){return this.count}getShapeList(){throw"此方法必须由子类重写"}config(){throw"此方法必须由子类重写"}mounted(){this._mounted&&"function"==typeof this._mounted&&this._mounted()}removed(){this._removed&&"function"==typeof this._removed&&this._removed()}drawPath(){throw"此方法必须由子类重写"}rotatePath(){throw"此方法必须由子类重写"}transFormPath(){throw"此方法必须由子类重写"}render(t){throw"此方法必须由子类重写"}}e.Base=o;e.shapeConfig=class{};e.Shape=class extends o{constructor(t,e){super(t,e),h.default[e].requiredProperties.map(i=>{if(void 0===t[i])throw`${i}为${e}的必填属性`}),this._x=t.pin[0],this._y=t.pin[1],this._color=t.color||"#000",this._fill=void 0===t.fill||t.fill,this._opacity=t.opacity||1,this._rotate=t.rotate||0,this._lastRotate=this._rotate,this._transform=t.transform||[],this.mouseIn=!1,this.eventList=[],this.camelCaseEventName={};for(let e in t)/^on./g.test(e)&&(this.camelCaseEventName[e]=t[e],this.bind(e.toLowerCase().substring(2),t[e]))}getBaseConfig(){return Object.assign({pin:[this._x,this._y],center:this._center,color:this._color,fill:this._fill,rotate:this._rotate,transform:this._transform,zIndex:this._zIndex,tag:this._tag},this.camelCaseEventName,{mounted:this._mounted,removed:this._removed})}isMouseIn(t){if(void 0===t)return this.mouseIn;this.mouseIn=t}getPath(){return this.path}setPath(t){this.path=t}setterX(t){let e=t-this._x;this._x=t,this._center[0]=this._center[0]+e,this.drawPath().rotatePath().transFormPath()}setterY(t){let e=t-this._y;this._y=t,this._center[1]=this._center[1]+e,this.drawPath().rotatePath().transFormPath()}setterZIndex(t){t!==this._zIndex&&(n.default.notify("remove",{shape:this,zIndex:this._zIndex}),n.default.notify("append",{shape:this,zIndex:t}),this._zIndex=t)}addEvent(t){t.map(t=>{t.fn instanceof Array?t.fn.map(e=>{n.default.notify("add_event",{shape:this,eventName:t.eventName,fn:e,zIndex:this._zIndex})}):n.default.notify("add_event",{shape:this,eventName:t.eventName,fn:t.fn,zIndex:this._zIndex})})}delEvent(t){t.map(t=>{"keypress"===t.eventName?n.default.notify("del_event",{shape:this,eventName:t.eventName,keyCode:t.keyCode}):n.default.notify("del_event",{shape:this,eventName:t.eventName})})}bind(t,e){"keypress"===t?e instanceof Array?e.map(t=>t.fn=t.fn.bind(this)):e.fn=e.fn.bind(this):e=e.bind(this),this.isMount&&this.addEvent([{eventName:t,fn:e}]),this.eventList.push({eventName:t,fn:e})}unbind(t,e){"keypress"===t?this.delEvent([{eventName:t,keyCode:e}]):this.delEvent([{eventName:t}])}getEventList(){return this.eventList}animateTo(t,e){let i=[],s=this;for(let e in t.target)h.default[s._type].animateProperties.includes(e)?i.push([s["_"+e],t.target[e]]):delete t.target[e];let a=new r.default({value:i,duration:t.duration,delay:t.delay,timingFunction:t.timingFunction,render:function(){let e=0;for(let i in t.target)s.attr(i,arguments[e++])}}).final(e);t.loop?a.loop():a.start()}mounted(){this.addEvent(this.eventList),this._mounted&&"function"==typeof this._mounted&&this._mounted()}removed(){this.delEvent(this.eventList),this._removed&&"function"==typeof this._removed&&this._removed()}drawPath(){return this}rotatePath(){if("circle"===this._type||"ellipse"===this._type||"Ring"===this._type)return this;if(this._lastRotate!==this._rotate){let t=new Path2D;t.addPath(this.path,s.rotate(a.Matrix.rotateMatrix,this._center,this._rotate)),this.path=t,this._lastRotate=this._rotate}return this}transFormPath(){if(this._transform.length){let t=new Path2D;t.addPath(this.path,s.transform(a.Matrix.transformMatrix,this._center,this._transform)),this.path=t}return this}render(t){this._show&&(t.globalAlpha=this._opacity,this._fill?(t.fillStyle=this._color,t.fill(this.path)):(t.strokeStyle=this._color,t.stroke(this.path)))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={listenerTable:{},addListener(t,e){this.listenerTable[t]=e},notify(t,...e){return this.listenerTable[t].apply(null,e)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(5);function a(t,e,i=!0){t.map(t=>{"Group"===t.attr("type")||"Composite"===t.attr("type")?(i&&e(t),a(t.getShapeList(),e)):e(t)})}e.DFS=a,e.calcCenter=function(t){let e=t[0][0],i=t[0][1],s=t[0][0],a=t[0][1];return t.map(t=>{t[0]<s&&(s=t[0]),t[0]>e&&(e=t[0]),t[1]<a&&(a=t[1]),t[1]>i&&(i=t[1])}),[(e-s)/2,(i-a)/2]},e.rotate=function(t,e,i){let s=i/180*Math.PI;return t.a=Math.cos(s),t.c=-1*Math.sin(s),t.b=Math.sin(s),t.d=Math.cos(s),t.e=-e[0]*Math.cos(s)+e[1]*Math.sin(s)+e[0],t.f=-e[0]*Math.sin(s)-e[1]*Math.cos(s)+e[1],t},e.transform=function(t,e,i){return 0===i.length?null:(t.a=i[0][0],t.c=i[0][1],t.b=i[1][0],t.d=i[1][1],t.e=-e[0]*i[0][0]-e[1]*i[0][1]+e[0],t.f=-e[0]*i[1][0]-e[1]*i[1][1]+e[1],t)},e.isInShape=function(t,e,i,n){if(e instanceof s.Composite){let s=!1;return a(e.getShapeList(),e=>{t.isPointInPath(e.getPath(),i,n)&&(s=!0)},!1),s}return t.isPointInPath(e.getPath(),i,n)},e.isInPath=function(t,e,i,n){if(e instanceof s.Composite){let s=!1;return a(e.getShapeList(),e=>{t.isPointInStroke(e.getPath(),i,n)&&(s=!0)},!1),s}return t.isPointInStroke(e.getPath(),i,n)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4);e.line=new class{constructor(){}init(t,e){return this.path=t,this.oX=e[0],this.oY=e[1],this.endX=this.oX,this.endY=this.oY,this.tPath=new Path2D,s.Matrix.translateMatrix.e=this.oX,s.Matrix.translateMatrix.f=this.oY,this.tPath.moveTo(0,0),this}bee(t){for(let e=0;e<t.length;e++)this.tPath.lineTo(t[e][0],t[e][1]);return this.endX=t[t.length-1][0],this.endY=t[t.length-1][1],this}bez(t,e,i){this.tPath.moveTo(this.endX,this.endY),this.tPath.bezierCurveTo(t[0],t[1],e[0],e[1],i[0],i[1]),this.endX=i[0],this.endY=i[1]}arc(t,e,i,s=!0){let a,n;return a=this.endX-t*Math.cos((360-e)/180*Math.PI),n=this.endY+t*Math.sin((360-e)/180*Math.PI),this.tPath.arc(a,n,t,e/180*Math.PI,i/180*Math.PI,s),this.endX=a-t*Math.cos((360-i)/180*Math.PI),this.endY=n+t*Math.sin((360-i)/180*Math.PI),this}move(t,e){this.tPath.moveTo(t,e),this.endX=t,this.endY=e}end(t=!0){t&&this.tPath.closePath(),this.path.addPath(this.tPath,s.Matrix.translateMatrix),s.Matrix.translateMatrix.e=s.Matrix.translateMatrix.f=0}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),a=i(10),n=i(1),r=i(13),h=i(14),o=i(15),d=i(16),u=i(17),p=i(18),c=i(19),l=i(20),_=i(21),f=i(22),m=i(23),P=i(5),g=i(24);e.Matrix={rotateMatrix:document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),transformMatrix:document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix(),translateMatrix:document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()},e.shapes={Custom:r.Custom,Circle:o.Circle,Rectangle:d.Rectangle,Triangle:h.Triangle,Group:m.Group,Composite:P.Composite,Ellipse:u.Ellipse,RoundRect:p.RoundRect,Sector:l.Sector,Ring:c.Ring,Polygon:_.Polygon,SVGPath:f.SVGPath,Text:g.TextBlock},e.utils={isInShape:s.isInShape,isInPath:s.isInPath};e.ContainerManager=class{constructor(t){this.defaultZIndex=100,this.totalShapeCount=0,this.container=t,this.containerSize=[this.container.offsetWidth,this.container.offsetHeight],this.layerMap={},n.default.addListener("clone",this.clone.bind(this)),n.default.addListener("update",this.update.bind(this)),n.default.addListener("append",this.append.bind(this)),n.default.addListener("remove",this.remove.bind(this))}createLayer(t){this.layerMap[t]=new a.default(t,this.defaultZIndex,this.container,this.containerSize)}getHeight(){return this.containerSize[0]}getWidth(){return this.containerSize[1]}getTotalCount(){for(let t in this.layerMap)this.totalShapeCount+=this.layerMap[t].getCount();return this.totalShapeCount}getLayerMap(){return this.layerMap}append(t){let e=t.zIndex;void 0===this.layerMap[e]&&this.createLayer(e),this.layerMap[e].append(t.shape)}remove(t){let e=t.zIndex;this.layerMap[e].remove(t.shape),0===this.layerMap[e].getCount()&&this.destroyLayer(e)}destroyLayer(t){this.container.removeChild(this.layerMap[t].getCanvasElement()),delete this.layerMap[t]}update(t){this.layerMap[t].update()}clear(){for(let t in this.layerMap)this.layerMap[t].clear(),"0"!==t&&this.destroyLayer(parseInt(t))}clone(t){if("Group"===t.attr("type")){let i=new e.shapes.Group(t.config());return s.DFS(t.getShapeList(),t=>{i.append(this.clone(t))}),i}if("Composite"===t.attr("type")){let i=new e.shapes.Composite(t.config());return s.DFS(t.getShapeList(),t=>{i.join(this.clone(t))}),i}return new(e.shapes[t.attr("type")])(t.config())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),a=i(1),n=i(2),r=i(4);e.Composite=class extends s.Shape{constructor(t){super(t,"Composite"),this.deep=void 0===t.deep||t.deep,this._center=t.center,this.shapeList=[],t&&t.shapes&&t.shapes.map(t=>{this.join(t,this.deep)}),this.initSetter()}join(t,e){if(t instanceof Array)t.map(t=>this.join(t,e));else{if("Group"===t.attr("type"))return void console.warn("group类型不能加入composite");this.shapeList.push(this.shapeProcessor(e?a.default.notify("clone",t):t)),this.isMount&&a.default.notify("update")}}config(){return Object.assign({},this.getBaseConfig(),{deep:this.deep,shapes:this.shapeList})}setterX(t){let e=t-this._x;this._x=t,this._center[0]=this._center[0]+e,this.shapeList.map(t=>{t.attr("x",t.attr("x")+e),this.shapeProcessor(t)})}setterY(t){let e=t-this._y;this._y=t,this._center[1]=this._center[1]+e,this.shapeList.map(t=>{t.attr("y",t.attr("y")+e),this.shapeProcessor(t)})}setterShow(t){this._show=t,this.shapeList.map(e=>{e.attr("show",t)})}setterRotate(t){this._rotate=t,n.DFS(this.getShapeList(),t=>{t.drawPath().rotatePath().transFormPath()},!1),this.shapeList.map(t=>{this.rotatePath(t)})}setterTransform(t){return n.DFS(this.getShapeList(),t=>{t.drawPath().rotatePath().transFormPath()},!1),this.shapeList.map(t=>{this.transFormPath(t)}),this}getShapeList(){return this.shapeList}shapeProcessor(t){return this._rotate&&this.rotatePath(t),this._transform&&this.transFormPath(t),t}rotatePath(t){if("Composite"===t.attr("type"))n.DFS(t.getShapeList(),t=>{let e=new Path2D;e.addPath(t.getPath(),n.rotate(r.Matrix.rotateMatrix,this._center,this._rotate)),t.setPath(e)},!1);else if("Text"===t.attr("type"))t.setCompositeRotate(this._center,this._rotate);else{let e=new Path2D;e.addPath(t.getPath(),n.rotate(r.Matrix.rotateMatrix,this._center,this._rotate)),t.setPath(e)}return this}transFormPath(t){if("Composite"===t.attr("type"))n.DFS(t.getShapeList(),t=>{let e=new Path2D;e.addPath(t.getPath(),n.transform(r.Matrix.transformMatrix,this._center,this._transform)),t.setPath(e)},!1);else{if("Text"===t.attr("type"))return this;{let e=new Path2D;e.addPath(t.getPath(),n.transform(r.Matrix.transformMatrix,this._center,this._transform)),t.setPath(e)}}return this}render(t){n.DFS(this.shapeList,e=>{t.save(),e.render(t),t.restore()},!1)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(8);var a;!function(t){t[t.init=0]="init",t[t.play=1]="play",t[t.stop=2]="stop",t[t.end=3]="end",t[t.final=4]="final"}(a||(a={}));e.default=class{constructor(t){this.isLoop=!1,this.animationQueue=[],this.animationQueueIndex=0,this.animationQueue.push(t),this.init(t)}init(t){return this._value=[],this._duration=t.duration||1e3,this._delay=t.delay||0,this._timingFunction=t.timingFunction?s.default[t.timingFunction]:s.default.linear,this._renderFunction=t.render||((...t)=>{}),this._onStart=t.onStart||(()=>{}),this._onEnd=t.onEnd||(()=>{}),this._onStop=t.onStop||(()=>{}),this.state=a.init,this.initValue(t.value),this}initValue(t){t.every(t=>t instanceof Array)?t.map(t=>{this._value.push({start:t[0],end:t[1]})}):this._value.push({start:t[0],end:t[1]})}animationFrame(){let t=Date.now()-this.beginTime;t>=this._duration||this.state===a.end?(this.renderFunction(this._duration,this._duration),this.end()):this.state===a.stop?this.renderFunction(t,this._duration):this.state===a.init?this.renderFunction(0,this._duration):(this.renderFunction(t,this._duration),window.requestAnimationFrame(this.animationFrame.bind(this)))}renderFunction(t,e){const i=this._value.map(i=>this._timingFunction(t,i.start,i.end-i.start,e));this._renderFunction.apply(this,i)}finalFunction(){this.isLoop?(this.state=a.init,this.animationQueueIndex=0,this.init(this.animationQueue[this.animationQueueIndex]).start()):this._onFinal&&this._onFinal()}start(){this.animationQueueIndex++,setTimeout(()=>{this.state=a.play,this.beginTime=Date.now(),this._onStart(),this.animationFrame()},this._delay)}loop(){this.isLoop=!0,this.start()}stop(){this.state===a.play&&(this.state=a.stop,this._onStop())}end(){this.state===a.play&&(this.state=a.end,this._onEnd(),this.animationQueueIndex<this.animationQueue.length?this.init(this.animationQueue[this.animationQueueIndex]).start():(this.state=a.final,this.finalFunction()))}final(t){return this._onFinal=t,this}next(t){return this.animationQueue.push(t),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4),a=i(6),n=i(25),r=i(26),h=i(12);e.default=function(t,e){return class{constructor(t){this.container=t,this.container.style.position="relative",this.container.style.userSelect="none",this.containerManager=new s.ContainerManager(this.container),this.eventSystem=new h.EventSystem(this.container,this.containerManager.getLayerMap()),this.motionHeap=new r.default,this.shapes=s.shapes,this.utils=s.utils,this.animation=a.default,this.motion=n.default}getHeight(){return this.container.offsetHeight}getWidth(){return this.container.offsetWidth}getShapesCount(){return this.containerManager.getTotalCount()}append(t){t instanceof Array?t.map(t=>this.containerManager.append({shape:t,zIndex:t.attr("zIndex")})):this.containerManager.append({shape:t,zIndex:t.attr("zIndex")})}remove(t){this.containerManager.remove({shape:t,zIndex:t.attr("zIndex")})}clear(){this.containerManager.clear()}clone(t){return this.containerManager.clone(t)}}}(window,document)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s={linear:(t,e,i,s)=>i*t/s+e,easeIn:(t,e,i,s)=>i*(t/=s)*t+e,easeOut:(t,e,i,s)=>-i*(t/=s)*(t-2)+e,easeInOut:(t,e,i,s)=>(t/=s/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e,easeInCubic:(t,e,i,s)=>i*(t/=s)*t*t+e,easeOutCubic:(t,e,i,s)=>i*((t=t/s-1)*t*t+1)+e,easeInOutCubic:(t,e,i,s)=>(t/=s/2)<1?i/2*t*t*t+e:i/2*((t-=2)*t*t+2)+e,easeInQuart:(t,e,i,s)=>i*(t/=s)*t*t*t+e,easeOutQuart:(t,e,i,s)=>-i*((t=t/s-1)*t*t*t-1)+e,easeInOutQuart:(t,e,i,s)=>(t/=s/2)<1?i/2*t*t*t*t+e:-i/2*((t-=2)*t*t*t-2)+e,easeInQuint:(t,e,i,s)=>i*(t/=s)*t*t*t*t+e,easeOutQuint:(t,e,i,s)=>i*((t=t/s-1)*t*t*t*t+1)+e,easeInOutQuint:(t,e,i,s)=>(t/=s/2)<1?i/2*t*t*t*t*t+e:i/2*((t-=2)*t*t*t*t+2)+e,easeInSine:(t,e,i,s)=>-i*Math.cos(t/s*(Math.PI/2))+i+e,easeOutSine:(t,e,i,s)=>i*Math.sin(t/s*(Math.PI/2))+e,easeInOutSine:(t,e,i,s)=>-i/2*(Math.cos(Math.PI*t/s)-1)+e,easeInExpo:(t,e,i,s)=>0==t?e:i*Math.pow(2,10*(t/s-1))+e,easeOutExpo:(t,e,i,s)=>t==s?e+i:i*(1-Math.pow(2,-10*t/s))+e,easeInOutExpo:(t,e,i,s)=>0==t?e:t==s?e+i:(t/=s/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(2-Math.pow(2,-10*--t))+e,easeInCirc:(t,e,i,s)=>-i*(Math.sqrt(1-(t/=s)*t)-1)+e,easeOutCirc:(t,e,i,s)=>i*Math.sqrt(1-(t=t/s-1)*t)+e,easeInOutCirc:(t,e,i,s)=>(t/=s/2)<1?-i/2*(Math.sqrt(1-t*t)-1)+e:i/2*(Math.sqrt(1-(t-=2)*t)+1)+e,easeInElastic(t,e,i,s,a,n){let r;return 0==t?e:1==(t/=s)?e+i:(void 0===n&&(n=.3*s),!a||a<Math.abs(i)?(r=n/4,a=i):r=n/(2*Math.PI)*Math.asin(i/a),-a*Math.pow(2,10*(t-=1))*Math.sin((t*s-r)*(2*Math.PI)/n)+e)},easeOutElastic(t,e,i,s,a,n){let r;return 0==t?e:1==(t/=s)?e+i:(void 0===n&&(n=.3*s),!a||a<Math.abs(i)?(a=i,r=n/4):r=n/(2*Math.PI)*Math.asin(i/a),a*Math.pow(2,-10*t)*Math.sin((t*s-r)*(2*Math.PI)/n)+i+e)},easeInOutElastic(t,e,i,s,a,n){let r;return 0==t?e:2==(t/=s/2)?e+i:(void 0===n&&(n=s*(.3*1.5)),!a||a<Math.abs(i)?(a=i,r=n/4):r=n/(2*Math.PI)*Math.asin(i/a),t<1?a*Math.pow(2,10*(t-=1))*Math.sin((t*s-r)*(2*Math.PI)/n)*-.5+e:a*Math.pow(2,-10*(t-=1))*Math.sin((t*s-r)*(2*Math.PI)/n)*.5+i+e)},easeInBack:(t,e,i,s,a)=>(void 0===a&&(a=1.70158),i*(t/=s)*t*((a+1)*t-a)+e),easeOutBack:(t,e,i,s,a)=>(void 0===a&&(a=1.70158),i*((t=t/s-1)*t*((a+1)*t+a)+1)+e),easeInOutBack:(t,e,i,s,a)=>(void 0===a&&(a=1.70158),(t/=s/2)<1?i/2*(t*t*((1+(a*=1.525))*t-a))+e:i/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+e),easeInBounce:(t,e,i,a)=>i-s.easeOutBounce(a-t,0,i,a)+e,easeOutBounce:(t,e,i,s)=>(t/=s)<1/2.75?i*(7.5625*t*t)+e:t<2/2.75?i*(7.5625*(t-=1.5/2.75)*t+.75)+e:t<2.5/2.75?i*(7.5625*(t-=2.25/2.75)*t+.9375)+e:i*(7.5625*(t-=2.625/2.75)*t+.984375)+e,easeInOutBounce:(t,e,i,a)=>t<a/2?.5*s.easeInBounce(2*t,0,i,a)+e:.5*s.easeOutBounce(2*t-a,0,i,a)+.5*i+e};e.default=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s={baseProp:{writableProperties:[],readonlyProperties:[],animateProperties:[],notRePathProperties:[],readableProperties:[],requiredProperties:[]},init(){return this.baseProp.writableProperties=["x","y","color","fill","opacity","rotate","transform","show","zIndex"],this.baseProp.readonlyProperties=["id","type","center","tag"],this.baseProp.animateProperties=["x","y","color","opacity","rotate"],this.baseProp.notRePathProperties=["color","fill","opacity","show"],this.baseProp.requiredProperties=["pin"],this.baseProp.readableProperties=[],this},handle(t,e,i){switch(t){case"add":this.add(e,i);break;case"remove":this.remove(e,i);break;case"replace":this.baseProp[e]=i}},writableProperties(t,e){return this.handle(t,"writableProperties",e),this},readonlyProperties(t,e){return this.handle(t,"readonlyProperties",e),this},animateProperties(t,e){return this.handle(t,"animateProperties",e),this},notRePathProperties(t,e){return this.handle(t,"notRePathProperties",e),this},requiredProperties(t,e){return this.handle(t,"requiredProperties",e),this},add(t,e){return Array.isArray(e)?e.map(e=>this.baseProp[t].push(e)):this.baseProp[t].push(e),this},remove(t,e){return Array.isArray(e)?e.map(e=>{this.baseProp[t].splice(this.baseProp[t].findIndex(t=>t===e),1)}):this.baseProp[t].splice(this.baseProp[t].findIndex(t=>t===e),1),this},merge:(t,e)=>t.concat(e),get(){return Object.assign({},this.baseProp,{readableProperties:this.merge(this.baseProp.readonlyProperties,this.baseProp.writableProperties)})}};e.default={Circle:(()=>(s.init(),s.writableProperties("add","radius"),s.animateProperties("add","radius"),s.requiredProperties("add","radius"),s.get()))(),Ring:(()=>(s.init(),s.writableProperties("add",["radius","width"]),s.animateProperties("add",["radius","width"]),s.requiredProperties("add",["radius","width"]),s.get()))(),Sector:(()=>(s.init(),s.writableProperties("add",["radius","range"]),s.animateProperties("add",["radius","range"]),s.requiredProperties("add",["radius","range"]),s.get()))(),Ellipse:(()=>(s.init(),s.writableProperties("add",["radiusX","radiusY"]),s.animateProperties("add",["radiusX","radiusY"]),s.requiredProperties("add","radius"),s.get()))(),Rectangle:(()=>(s.init(),s.writableProperties("add",["width","height"]),s.animateProperties("add",["width","height"]),s.requiredProperties("add",["edge"]),s.get()))(),RoundRect:(()=>(s.init(),s.writableProperties("add",["round","height","width"]),s.animateProperties("add",["round","height","width"]),s.requiredProperties("add",["round","edge"]),s.get()))(),Triangle:(()=>(s.init(),s.writableProperties("add","edge"),s.animateProperties("add","edge"),s.requiredProperties("add","edge"),s.get()))(),Polygon:(()=>(s.init(),s.writableProperties("add","path"),s.requiredProperties("add","path"),s.get()))(),Custom:(()=>(s.init(),s.requiredProperties("add","center"),s.get()))(),SVGPath:(()=>(s.init(),s.writableProperties("add","svgPath"),s.requiredProperties("add",["svgPath","center"]),s.get()))(),Text:(()=>(s.init(),s.writableProperties("remove","transform"),s.writableProperties("add",["align","dir","content","fontSize"]),s.animateProperties("add","fontSize"),s.notRePathProperties("replace",s.merge(s.baseProp.writableProperties,s.baseProp.readonlyProperties)),s.get()))(),Composite:(()=>(s.init(),s.writableProperties("remove",["color","fill","opacity"]),s.animateProperties("remove",["color","opacity"]),s.notRePathProperties("remove",["color","fill","opacity"]),s.requiredProperties("add","center"),s.get()))(),Group:(()=>(s.init(),s.readonlyProperties("remove","center"),s.writableProperties("replace",["show"]),s.animateProperties("replace",[]),s.notRePathProperties("replace",["show"]),s.get()))()}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(11);e.default=class{constructor(t,e,i,a){this.zIndex=t,this.canvas=this.createCanvasElement(t,e,i,a),this.ctx=this.canvas.getContext("2d"),this.shapeHeap=new s.shapeHeap(this.ctx,a),this.count=0}createCanvasElement(t,e,i,s){let a=document.createElement("canvas");return a.style.position="absolute",a.style.top="0",a.style.left="0",a.width=s[0],a.height=s[1],a.style.zIndex=(t+e).toString(),i.appendChild(a),a}getCount(){return this.count}getCTX(){return this.ctx}append(t){this.shapeHeap.append(t),this.update(),this.count+=t.getCount()}remove(t){this.shapeHeap.remove(t),this.update(),this.count-=t.getCount()}update(){this.shapeHeap.update()}clear(){this.count=0,this.shapeHeap.clear()}getCanvasElement(){return this.canvas}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.shapeHeap=class{constructor(t,e){this.shapeHeapArray=new Array,this.ctx=t,this.containerSize=e,this.aSyncUpdateRequestCount=0,this.updateRequestCount=0}append(t){this.shapeHeapArray.push(t),t.toggleMount(!0)}remove(t){let e=t.attr("id");this.shapeHeapArray.map((t,i)=>{t.attr("id")===e&&this.shapeHeapArray.splice(i,1)}),t.toggleMount(!1)}clear(){this.shapeHeapArray.map(t=>{t.toggleMount(!1)}),this.shapeHeapArray=[],this.ctx.clearRect(0,0,this.containerSize[0],this.containerSize[1])}update(){this.updateRequestCount++,requestAnimationFrame(function(){this.aSyncUpdateRequestCount++,this.aSyncUpdateRequestCount===this.updateRequestCount&&(this.updateRequestCount=this.aSyncUpdateRequestCount=0,this.reRender())}.bind(this))}reRender(){this.ctx.clearRect(0,0,this.containerSize[0],this.containerSize[1]);for(let t=0,e=this.shapeHeapArray.length;t<e;t++)this.ctx.save(),this.shapeHeapArray[t].render(this.ctx),this.ctx.restore()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),a=i(1);e.eventInfo=class{};e.keyBoardEvent=class{};e.event=class{};e.EventSystem=class{constructor(t,e){this.eventList=["click","mousemove","keypress","mouseover","mouseout"],this.container=t,this.layerMap=e,this.containerLeft=t.scrollLeft+t.clientLeft,this.containerTop=t.scrollTop+t.clientTop,this.clickEventList=[],this.mouseoverEventList=[],this.mouseoutEventList=[],this.mousemoveEventList=[],this.mousedownEventList=[],this.mouseupEventList=[],this.keypressEventMap={},a.default.addListener("add_event",this.addEvent.bind(this)),a.default.addListener("del_event",this.delEvent.bind(this)),this.init()}init(){this.bindKeyBoardEvent(),this.bindMouseEvent()}omitEvent(t,e,i,s){e({target:t,x:i,y:s})}bindMouseEvent(){this.container.addEventListener("click",t=>{let e=t.clientX-this.containerLeft,i=t.clientY-this.containerTop;this.clickEventList.map(t=>{s.isInShape(t.ctx,t.shape,e,i)&&this.omitEvent(t.shape,t.fn,e,i)})}),this.container.addEventListener("mousedown",t=>{let e=t.clientX-this.containerLeft,i=t.clientY-this.containerTop;this.mousedownEventList.map(t=>{s.isInShape(t.ctx,t.shape,e,i)&&this.omitEvent(t.shape,t.fn,e,i)})}),this.container.addEventListener("mouseup",t=>{let e=t.clientX-this.containerLeft,i=t.clientY-this.containerTop;this.mouseupEventList.map(t=>{s.isInShape(t.ctx,t.shape,e,i)&&this.omitEvent(t.shape,t.fn,e,i)})}),this.container.addEventListener("mousemove",t=>{let e=t.clientX-this.containerLeft,i=t.clientY-this.containerTop;this.mouseoverEventList.map(t=>{s.isInShape(t.ctx,t.shape,e,i)&&(t.shape.isMouseIn()||(this.omitEvent(t.shape,t.fn,e,i),t.shape.isMouseIn(!0)))}),this.mouseoutEventList.map(t=>{s.isInShape(t.ctx,t.shape,e,i)||t.shape.isMouseIn()&&(this.omitEvent(t.shape,t.fn,e,i),t.shape.isMouseIn(!1))}),this.mousemoveEventList.map(t=>{s.isInShape(t.ctx,t.shape,e,i)&&(this.omitEvent(t.shape,t.fn,e,i),t.shape.isMouseIn(!0))})})}bindKeyBoardEvent(){document.addEventListener("keydown",t=>{this.keypressEventMap[t.keyCode]&&this.keypressEventMap[t.keyCode].map(t=>{this.omitEvent(t.shape,t.fn.fn)})})}addEvent(t){t.ctx=this.layerMap[t.zIndex].getCTX(),"keypress"===t.eventName?(void 0===this.keypressEventMap[t.fn.keyCode]&&(this.keypressEventMap[t.fn.keyCode]=[]),this.keypressEventMap[t.fn.keyCode].push(t)):this[t.eventName+"EventList"].push(t)}delEvent(t){let e=null;"keypress"===t.eventName?(e=this.keypressEventMap[t.keyCode]).map((i,s)=>{i.shape.attr("id")===t.shape.attr("id")&&e.splice(s,1)}):(e=this[t.eventName+"EventList"]).map((i,s)=>{i.shape.attr("id")===t.shape.attr("id")&&e.splice(s,1)})}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),a=i(3);e.Custom=class extends s.Shape{constructor(t){super(t,"Custom"),this._center=t.center,this._fillRule=t.fillRule||!0,this._draw=t.draw,this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{draw:this._draw})}drawPath(){return this.path=new Path2D,this._draw(this.path,a.line.init(this.path,[this._x,this._y])),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),a=i(3);e.Triangle=class extends s.Shape{constructor(t){super(t,"Triangle"),this._edge=t.edge,this.midEdge=this._edge/2,this.height=Math.sqrt(this._edge*this._edge-this.midEdge*this.midEdge),this._center=[this._x,this._y+this.height/2],this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{edge:this._edge})}drawPath(){return this.path=new Path2D,a.line.init(this.path,[this._x,this._y]).bee([[-this.midEdge,this.height],[this.midEdge,this.height],[0,0]]).end(),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.Circle=class extends s.Shape{constructor(t){super(t,"Circle"),this._center=[this._x,this._y],this._radius=t.radius,this.initSetter(),this.drawPath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{radius:this._radius})}drawPath(){return this.path=new Path2D,this.path.arc(this._x,this._y,this._radius,0,2*Math.PI,!0),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),a=i(3);e.Rectangle=class extends s.Shape{constructor(t){super(t,"Rectangle"),this._width=t.edge[0],this._height=t.edge[1],this._center=[this._x+this._width/2,this._y+this._height/2],this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{edge:[this._width,this._height]})}drawPath(){return this.path=new Path2D,a.line.init(this.path,[this._x,this._y]).bee([[this._width,0],[this._width,this._height],[0,this._height],[0,0]]).end(),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.Ellipse=class extends s.Shape{constructor(t){super(t,"Ellipse"),this._center=[this._x,this._y],this._radiusX=t.radius[0],this._radiusY=t.radius[1],this.initSetter(),this.drawPath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{radius:[this._radiusX,this._radiusY]})}setterRadiusX(t){this._radiusX=t,this.drawPath().transFormPath()}setterRadiusY(t){this._radiusY=t,this.drawPath().transFormPath()}setterRotate(t){this._rotate=t,this.drawPath().transFormPath()}drawPath(){return this.path=new Path2D,this.path.ellipse(this._x,this._y,this._radiusX,this._radiusY,this._rotate/180*Math.PI,0,2*Math.PI,!0),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),a=i(3);e.RoundRect=class extends s.Shape{constructor(t){super(t,"RoundRect"),this._width=t.edge[0],this._height=t.edge[1],this._round=t.round,this._center=[this._x+this._width/2,this._y+this._height/2+this._round],this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{edge:[this._width,this._height],round:this._round})}drawPath(){return this.path=new Path2D,a.line.init(this.path,[this._x,this._y+this._round]).bee([[0,this._height-this._round]]).arc(this._round,180,90).bee([[this._width-this._round,this._height]]).arc(this._round,90,0).bee([[this._width,this._round]]).arc(this._round,0,-90).bee([[this._round,0]]).arc(this._round,-90,-180).end(),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.Ring=class extends s.Shape{constructor(t){super(t,"Ring"),this._center=[this._x,this._y],this._radius=t.radius,this._width=t.width,this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{radius:this._radius,width:this._width})}drawPath(){return this.path=new Path2D,this.path.arc(this._x,this._y,this._radius+this._width,0,2*Math.PI,!1),this.path.arc(this._x,this._y,this._radius,0,2*Math.PI,!0),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.Sector=class extends s.Shape{constructor(t){super(t,"Sector"),this._center=[this._x,this._y],this._radius=t.radius,this._range=t.range,this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{radius:this._radius,range:this._range})}drawPath(){return this.path=new Path2D,this.path.arc(this._x,this._y,this._radius,this._range[0]/180*Math.PI,this._range[1]/180*Math.PI,!0),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),a=i(3),n=i(2);e.Polygon=class extends s.Shape{constructor(t){super(t,"Polygon"),this._path=t.path,this._center=n.calcCenter(this._path),this.initSetter(),this.drawPath().rotatePath().transFormPath()}config(){return Object.assign({},this.getBaseConfig(),{path:this._path})}drawPath(){return this.path=new Path2D,this._path.length>1&&a.line.init(this.path,[this._x,this._y]).bee(this._path).end(),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.SVGPath=class extends s.Shape{constructor(t){super(t,"SVGPath")}config(){return Object.assign({},this.getBaseConfig(),{svgPath:this._svgPath})}renderPath(){return this.path=new Path2D(this._svgPath),this}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),a=i(2),n=i(0);e.Group=class extends n.Base{constructor(t){super(t,"Group"),this.count=0,this.shapeList=[],t&&t.shapes&&t.shapes.map(t=>{this.append(t)}),this.initSetter()}config(){return{shapes:this.shapeList,mounted:this._mounted,removed:this._removed,tag:this._tag,zIndex:this._zIndex}}setShow(t){this._show=t,this.shapeList.map(e=>{e.attr("show",t)})}getShapeList(){return this.shapeList}isShapeAt(t){return this.shapeList.some(e=>e.attr("id")===t.attr("id"))}append(t){t instanceof Array?t.map(t=>this.append(t)):(this.shapeList.push(t),this.count+=t.getCount(),this.isMount&&s.default.notify("update"))}remove(t){let e=t.attr("id");this.shapeList.map((t,i)=>{t.attr("id")===e&&this.shapeList.splice(i,1)}),this.count-=t.getCount(),this.isMount&&s.default.notify("update")}render(t){a.DFS(this.shapeList,e=>{t.save(),e.render(t),t.restore()},!1)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.TextBlock=class extends s.Shape{constructor(t){super(t,"Text"),this._maxWidth=t.maxWidth||null,this._fontSize=t.fontSize||10,this._content=t.content||"",this._align=t.align||"start",this._direction=t.dir||"inherit",this.font="px sans-serif",this._center=[],this.compositeCenter=[],this.compositeRotate=0,this.initSetter()}config(){return Object.assign({},this.getBaseConfig(),{content:this._content,fontSize:this._fontSize,align:this._align,dir:this._direction,maxWidth:this._maxWidth})}setCompositeRotate(t,e){this.compositeCenter=t,this.compositeRotate=e}textRotate(t,e,i){t.translate(e[0],e[1]),t.rotate(i/180*Math.PI),t.translate(-e[0],-e[1])}drawPath(){return this}rotatePath(){return this}transFormPath(){return this}render(t){this._show&&(this.compositeCenter.length&&this.textRotate(t,this.compositeCenter,this.compositeRotate),this.textRotate(t,[this._x+t.measureText(this._content).width,this._y-this._fontSize/2],this._rotate),t.font=this._fontSize+this.font,t.direction=this._direction,t.textAlign=this._align,t.globalAlpha=this._opacity,this._fill?(t.fillStyle=this._color,this._maxWidth?t.fillText(this._content,this._x,this._y,this._maxWidth):t.fillText(this._content,this._x,this._y)):(t.strokeStyle=this._color,this._maxWidth?t.strokeText(this._content,this._x,this._y,this._maxWidth):t.strokeText(this._content,this._x,this._y)))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.default=class{constructor(t){this.id=Symbol(),this.shape=t,this.thresholdList=[]}motionFrame(){this.vel.x+=this.acc.x,this.vel.y+=this.acc.y,this.pos.x+=this.vel.x,this.pos.y+=this.vel.y,this.thresholdList.map(t=>t(this)),this.shape.attr("x",this.pos.x).attr("y",this.pos.y)}start(t,e,i){return this.pos={x:this.shape.attr("x"),y:this.shape.attr("y")},this.vel={x:t[0],y:t[1]},this.acc={x:e[0],y:e[1]},this.endFunction=i,s.default.notify("add_motion",this),this}end(){s.default.notify("del_motion",this)}rule(t){return this.thresholdList.push(t),this}posX(t){if(void 0===t)return this.pos.x;this.pos.x=t}posY(t){if(void 0===t)return this.pos.y;this.pos.y=t}velX(t){if(void 0===t)return this.vel.x;this.vel.x=t}velY(t){if(void 0===t)return this.vel.y;this.vel.y=t}accX(t){if(void 0===t)return this.acc.x;this.acc.x=t}accY(t){if(void 0===t)return this.acc.y;this.acc.y=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.default=class{constructor(){this.isRun=!1,this.motionList=[],s.default.addListener("add_motion",this.add.bind(this)),s.default.addListener("del_motion",this.del.bind(this))}loopFrame(){for(let t=0,e=this.motionList.length;t<e;t++)this.motionList[t]&&this.motionList[t].motionFrame();this.isRun?this.raf=window.requestAnimationFrame(this.loopFrame.bind(this)):window.cancelAnimationFrame(this.raf)}del(t){this.motionList.splice(this.motionList.findIndex(e=>e.id===t.id),1),0===this.motionList.length&&(this.isRun=!1)}add(t){let e=null;(e=this.motionList.find(e=>e.id===t.id))?(e.vel=t.vel,e.acc=t.acc):this.motionList.push(t),!this.isRun&&this.motionList.length&&(this.isRun=!0,this.loopFrame())}}}]);