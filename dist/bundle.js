var P2=function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=4)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(3);e.broadcast={listener:Function,init(t){this.listener=t},notify(){this.listener()}},e.DFS=function t(e,i){e.map(e=>{e instanceof s.group?(i(e),t(e.getShapeList(),i)):i(e)})},e.calcCenter=function(t){return[]},e.rotate=function(t,e,i){t.translate(e[0],e[1]),t.rotate(i/180*Math.PI),t.translate(-e[0],-e[1])}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.shapeConfig=class{};class o{constructor(t,e){this._id=Symbol(),this._type=e,this._isShow=!0,this._isMount=!1,this._mounted=void 0!==t?t.mounted:()=>{},this._removed=void 0!==t?t.removed:()=>{}}id(){return this._id}type(){return this._type}isMount(t){if(void 0===t||"boolean"!=typeof t)return this._isMount;this._isMount=t}show(t){return void 0!==t&&"boolean"==typeof t?(this._isShow=t,this._isMount&&s.broadcast.notify(),this):this._isShow}config(){}mounted(){this._mounted&&"function"==typeof this._mounted&&this._mounted()}removed(){this._removed&&"function"==typeof this._removed&&this._removed()}}e.base=o;e.shape=class extends o{constructor(t,e){super(t,e),this._x=t.pin[0],this._y=t.pin[1],this._color=t.color,this._fill=void 0===t.fill||t.fill,this._rotate=t.rotate||0}x(t){return void 0!==t&&"number"==typeof t?(this._x=t,this._isMount&&s.broadcast.notify(),this):this._x}y(t){return void 0!==t&&"number"==typeof t?(this._y=t,this._isMount&&s.broadcast.notify(),this):this._y}color(t){return void 0!==t&&"string"==typeof t?(this._color=t,this._isMount&&s.broadcast.notify(),this):this._color}fill(t){return void 0!==t&&"boolean"==typeof t?(this._fill=t,this._isMount&&s.broadcast.notify(),this):this._fill}rotate(t){return void 0!==t&&"number"==typeof t?(this._rotate=t,this._isMount&&s.broadcast.notify(),this):this._rotate}getBaseConfig(){return{pin:[this._x,this._y],color:this._color,fill:this._fill,rotate:this._rotate}}bind(){}animate(t){}start(t){}end(t){}draw(t){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),o=i(5),n=i(6),r=i(7),h=i(8),a=i(3),c=i(9);e.shapeHeap=class{constructor(t,e){this.shapeHeapArray=new Array,this.count=0,this.ctx=t,this.canvasInfo=e}getCount(){return this.count}append(t){this.shapeHeapArray.push(t),t.isMount(!0),t.mounted(),t instanceof a.group?(s.DFS(t.getShapeList(),t=>{t.isMount(!0),t.mounted()}),this.count+=t.getCount()):this.count+=1,s.broadcast.notify()}remove(t){let e=t.id();this.shapeHeapArray.map((t,i)=>{t.id()===e&&this.shapeHeapArray.splice(i,1)}),t.isMount(!1),t.removed(),t instanceof a.group?(s.DFS(t.getShapeList(),t=>{t.isMount(!1),t.removed()}),this.count-=t.getCount()):this.count-=1,s.broadcast.notify()}clone(t){if(t instanceof a.group){let i=new e.shapes.group(t.config());return s.DFS(t.getShapeList(),t=>{i.append(this.clone(t))}),i}return new(e.shapes[t.type()])(t.config())}clear(){s.DFS(this.shapeHeapArray,t=>{t.isMount(!1)}),this.shapeHeapArray=[],this.count=0,this.ctx.clearRect(0,0,this.canvasInfo.width,this.canvasInfo.height)}reRender(){this.ctx.clearRect(0,0,this.canvasInfo.width,this.canvasInfo.height),this.render(this.shapeHeapArray)}render(t){t.map(t=>{t.show()&&(t instanceof a.group?this.render(t.getShapeList()):(this.ctx.save(),t.draw(this.ctx),this.ctx.restore()))})}},e.shapes={custom:o.custom,circle:r.circle,rectangle:h.rectangle,triangle:n.triangle,group:a.group,composite:c.composite}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);class n extends s.base{constructor(t){super(t,"group"),this.count=0,this.shapeList=new Array}config(){return{mounted:this._mounted,removed:this._removed}}getCount(){return this.count}getShapeList(){return this.shapeList}append(t){this.shapeList.push(t),this.count+=t instanceof n?t.getCount():1,this._isMount&&o.broadcast.notify()}remove(t){let e=t.id();this.shapeList.map((t,i)=>{t.id()===e&&this.shapeList.splice(i,1)}),this.count-=t instanceof n?t.getCount():1,this._isMount&&o.broadcast.notify()}}e.group=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),o=i(2),n=i(0);e.default=function(t,e){class i{constructor(t,e){this.ele=null,this.config={width:400,height:400,backgroundColor:"#eee"},this.ele=t,this.config=e||this.config,this.setWidth().setHeight().setBackgroundColor()}setWidth(){let t="fullWidth"===this.config.width?e.body.clientWidth:this.config.width;return this.ele.setAttribute("width",t.toString()),this.width=parseInt(t.toString()),this}setHeight(){let t="fullHeight"===this.config.height?e.body.clientHeight:this.config.height;return this.ele.setAttribute("height",t.toString()),this.height=parseInt(t.toString()),this}setBackgroundColor(){return this.ele.style.backgroundColor=this.config.backgroundColor,this}}return class{constructor(t,e){this.canvasEle=t,this.ctx=t.getContext("2d"),this.canvasStyle=new i(t,e),this.shapeHeap=new o.shapeHeap(this.ctx,{width:this.getWidth(),height:this.getHeight()}),n.broadcast.init(this.shapeHeap.reRender.bind(this.shapeHeap)),this.shapes=s.shapes}getHeight(){return this.canvasStyle.height}getWidth(){return this.canvasStyle.width}getShapesCount(){return this.shapeHeap.getCount()}append(t){this.shapeHeap.append(t)}remove(t){this.shapeHeap.remove(t)}clear(){this.shapeHeap.clear()}clone(t){return this.shapeHeap.clone(t)}}}(window,document)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(10);e.custom=class extends s.shape{constructor(t){super(t,"custom"),this._x=t.pin[0],this._y=t.pin[1],this._draw=t.draw}config(){return Object.assign({},this.getBaseConfig(),{draw:this._draw})}draw(t){this._draw(t,o.line.init(t,this))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.triangle=class extends s.shape{constructor(t){super(t,"triangle"),this._edge=t.edge}config(){return Object.assign({},this.getBaseConfig(),{edge:this._edge})}edge(t){return void 0!==t&&"number"==typeof t?(this._edge=t,this._isMount&&o.broadcast.notify(),this):this._edge}draw(t){let e=this._edge/2,i=Math.sqrt(this._edge*this._edge-e*e);o.rotate(t,[this._x,this._y+i/2],this._rotate),t.beginPath(),t.moveTo(this._x,this._y),t.lineTo(this._x-e,this._y+i),t.lineTo(this._x+e,this._y+i),this._fill?(t.fillStyle=this._color,t.fill()):(t.strokeStyle=this._color,t.closePath(),t.stroke())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.circle=class extends s.shape{constructor(t){super(t,"circle"),this._radius=t.radius}radius(t){return void 0!==t&&"number"==typeof t?(this._radius=t,this._isMount&&o.broadcast.notify(),this):this._radius}config(){return Object.assign({},this.getBaseConfig(),{radius:this._radius})}draw(t){t.beginPath(),t.arc(this._x,this._y,this._radius,0,2*Math.PI,!0),this._fill?(t.fillStyle=this._color,t.fill()):(t.strokeStyle=this._color,t.stroke())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.rectangle=class extends s.shape{constructor(t){super(t,"rectangle"),this._width=t.edge[0],this._height=t.edge[1]}config(){return Object.assign({},this.getBaseConfig(),{edge:[this._width,this._height]})}width(t){return void 0!==t&&"number"==typeof t?(this._width=t,this._isMount&&o.broadcast.notify(),this):this._width}height(t){return void 0!==t&&"number"==typeof t?(this._height=t,this._isMount&&o.broadcast.notify(),this):this._height}draw(t){o.rotate(t,[this._x+this._width/2,this._y+this._height/2],this._rotate),this._fill?(t.fillStyle=this._color,t.fillRect(this._x,this._y,this._width,this._height)):(t.strokeStyle=this._color,t.strokeRect(this._x,this._y,this._width,this._height))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.composite=class extends s.base{constructor(t){super(t,"composite"),this._x=t.pin[0],this._y=t.pin[1]}config(){return{pin:[this._x,this._y],mounted:this._mounted,removed:this._removed}}x(t){return void 0!==t&&"number"==typeof t?(this._x=t,this._isMount&&o.broadcast.notify(),this):this._x}y(t){return void 0!==t&&"number"==typeof t?(this._y=t,this._isMount&&o.broadcast.notify(),this):this._y}join(t){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.line=new class{constructor(){}init(t,e){return this.ctx=t,this.oX=e.x(),this.oY=e.y(),this.color=e.color(),this.fill=e.fill(),this}start(t){return this.endX=t[0],this.endY=t[1],this.ctx.translate(this.oX,this.oY),this.ctx.fillStyle=this.color,this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.ctx.moveTo(this.endX,this.endY),this}bee(t){for(let e=0;e<t.length;e++)this.ctx.lineTo(t[e][0],t[e][1]);return this.endX=t[t.length-1][0],this.endY=t[t.length-1][1],this}arc(t,e,i,s=!0){let o,n;return o=this.endX-t*Math.cos((360-e)/180*Math.PI),n=this.endY+t*Math.sin((360-e)/180*Math.PI),this.ctx.arc(o,n,t,e/180*Math.PI,i/180*Math.PI,s),this.endX=o-t*Math.cos((360-i)/180*Math.PI),this.endY=n+t*Math.sin((360-i)/180*Math.PI),this}end(){this.fill?this.ctx.fill():this.ctx.stroke()}}}]);