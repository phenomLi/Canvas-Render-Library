var P2=function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4),o=i(5),r=i(6),n=i(7),h=i(2);e.broadcast={listener:Function,init(t){this.listener=t},notify(){this.listener()}},e.DFS=function t(e,i){e.map(e=>{e instanceof h.group?(i(e),t(e.getShapeList(),i)):i(e)})},e.calcCenter=function(t){return[]},e.rotate=function(t,e,i){t.translate(e[0],e[1]),t.rotate(i/180*Math.PI),t.translate(-e[0],-e[1])},e.shapes={custom:s.custom,circle:r.circle,rectangle:n.rectangle,triangle:o.triangle,group:h.group}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);e.shapeConfig=class{};e.shape=class{constructor(t){this._id=Symbol(),this._isMount=!1,this._x=t.pin[0],this._y=t.pin[1],this._color=t.color,this._fill=void 0===t.fill||t.fill,this._rotate=t.rotate||0}id(){return this._id}type(){return this._type}isMount(t){if(void 0===t||"boolean"!=typeof t)return this._isMount;this._isMount=t}x(t){return void 0!==t&&"number"==typeof t?(this._x=t,this._isMount&&s.broadcast.notify(),this):this._x}y(t){return void 0!==t&&"number"==typeof t?(this._y=t,this._isMount&&s.broadcast.notify(),this):this._y}color(t){return void 0!==t&&"string"==typeof t?(this._color=t,this._isMount&&s.broadcast.notify(),this):this._color}fill(t){return void 0!==t&&"boolean"==typeof t?(this._fill=t,this._isMount&&s.broadcast.notify(),this):this._fill}rotate(t){return void 0!==t&&"number"==typeof t?(this._rotate=t,this._isMount&&s.broadcast.notify(),this):this._rotate}path(t){return void 0!==t&&t instanceof Array?(this._path=t,this._isMount&&s.broadcast.notify(),this):this._path}config(){}getBaseConfig(){return{pin:[this._x,this._y],color:this._color,fill:this._fill,rotate:this._rotate}}bind(){}animate(t){}start(t){}end(t){}mounted(){}removed(){}draw(t){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0);class o{constructor(){this._isMount=!1,this._id=Symbol(),this._type="group",this.count=0,this.shapeList=new Array}id(){return this._id}type(){return this._type}getCount(){return this.count}isMount(t){if(void 0===t||"boolean"!=typeof t)return this._isMount;this._isMount=t}getShapeList(){return this.shapeList}append(t){this.shapeList.push(t),this.count+=t instanceof o?t.getCount():1,this._isMount&&s.broadcast.notify()}remove(t){let e=t.id();this.shapeList.map((t,i)=>{t.id()===e&&this.shapeList.splice(i,1)}),this.count-=t instanceof o?t.getCount():1,this._isMount&&s.broadcast.notify()}}e.group=o},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(0),o=i(8),r=i(0);e.default=function(t,e){class i{constructor(t,e){this.ele=null,this.config={width:400,height:400,backgroundColor:"#eee"},this.ele=t,this.config=e||this.config,this.setWidth().setHeight().setBackgroundColor()}setWidth(){let t="fullWidth"===this.config.width?e.body.clientWidth:this.config.width;return this.ele.setAttribute("width",t.toString()),this.width=parseInt(t.toString()),this}setHeight(){let t="fullHeight"===this.config.height?e.body.clientHeight:this.config.height;return this.ele.setAttribute("height",t.toString()),this.height=parseInt(t.toString()),this}setBackgroundColor(){return this.ele.style.backgroundColor=this.config.backgroundColor,this}}return class{constructor(t,e){this.canvasEle=t,this.ctx=t.getContext("2d"),this.canvasStyle=new i(t,e),this.shapeHeap=new o.shapeHeap(this.ctx,{width:this.getWidth(),height:this.getHeight()}),r.broadcast.init(this.shapeHeap.reRender.bind(this.shapeHeap)),this.shapes=s.shapes}getHeight(){return this.canvasStyle.height}getWidth(){return this.canvasStyle.width}getShapesCount(){return this.shapeHeap.getCount()}append(t){this.shapeHeap.append(t)}remove(t){this.shapeHeap.remove(t)}clear(){this.shapeHeap.clear()}clone(t){return this.shapeHeap.clone(t)}}}(window,document)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1);e.custom=class extends s.shape{constructor(t){super(t),this._type="custom",this._path=t.path}config(){return Object.assign({},this.getBaseConfig(),{path:this._path})}draw(t){t.beginPath(),t.arc(100,100,50,0,Math.PI/2,!1),t.lineTo(200,200),t.stroke()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.triangle=class extends s.shape{constructor(t){super(t),this._type="triangle",this._edge=t.edge}config(){return Object.assign({},this.getBaseConfig(),{edge:this._edge})}edge(t){return void 0!==t&&"number"==typeof t?(this._edge=t,this._isMount&&o.broadcast.notify(),this):this._edge}draw(t){let e=this._edge/2,i=Math.sqrt(this._edge*this._edge-e*e);o.rotate(t,[this._x,this._y+i/2],this._rotate),t.beginPath(),t.moveTo(this._x,this._y),t.lineTo(this._x-e,this._y+i),t.lineTo(this._x+e,this._y+i),this._fill?(t.fillStyle=this._color,t.fill()):(t.strokeStyle=this._color,t.closePath(),t.stroke())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.circle=class extends s.shape{constructor(t){super(t),this._type="circle",this._radius=t.radius}radius(t){return void 0!==t&&"number"==typeof t?(this._radius=t,this._isMount&&o.broadcast.notify(),this):this._radius}config(){return Object.assign({},this.getBaseConfig(),{radius:this._radius})}draw(t){t.beginPath(),t.arc(this._x,this._y,this._radius,0,2*Math.PI,!0),this._fill?(t.fillStyle=this._color,t.fill()):(t.strokeStyle=this._color,t.stroke())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(1),o=i(0);e.rectangle=class extends s.shape{constructor(t){super(t),this._type="rectangle",this._width=t.edge[0],this._height=t.edge[1]}config(){return Object.assign({},this.getBaseConfig(),{edge:[this._width,this._height]})}width(t){return void 0!==t&&"number"==typeof t?(this._width=t,this._isMount&&o.broadcast.notify(),this):this._width}height(t){return void 0!==t&&"number"==typeof t?(this._height=t,this._isMount&&o.broadcast.notify(),this):this._height}draw(t){o.rotate(t,[this._x+this._width/2,this._y+this._height/2],this._rotate),this._fill?(t.fillStyle=this._color,t.fillRect(this._x,this._y,this._width,this._height)):(t.strokeStyle=this._color,t.strokeRect(this._x,this._y,this._width,this._height))}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(2),o=i(0);e.shapeHeap=class{constructor(t,e){this.shapeHeapArray=new Array,this.count=0,this.ctx=t,this.canvasInfo=e}getCount(){return this.count}append(t){this.shapeHeapArray.push(t),t.isMount(!0),t instanceof s.group?(o.DFS(t.getShapeList(),t=>{t.isMount(!0)}),this.count+=t.getCount()):this.count+=1,o.broadcast.notify()}remove(t){let e=t.id();this.shapeHeapArray.map((t,i)=>{t.id()===e&&this.shapeHeapArray.splice(i,1)}),t.isMount(!1),t instanceof s.group?(o.DFS(t.getShapeList(),t=>{t.isMount(!1)}),this.count-=t.getCount()):this.count-=1,o.broadcast.notify()}clone(t){if(t instanceof s.group){let e=new o.shapes.group;return o.DFS(t.getShapeList(),t=>{e.append(this.clone(t))}),e}return new(o.shapes[t.type()])(t.config())}clear(){o.DFS(this.shapeHeapArray,t=>{t.isMount(!1)}),this.shapeHeapArray=[],this.count=0,this.ctx.clearRect(0,0,this.canvasInfo.width,this.canvasInfo.height)}reRender(){this.ctx.clearRect(0,0,this.canvasInfo.width,this.canvasInfo.height),this.render(this.shapeHeapArray)}render(t){t.map(t=>{t instanceof s.group?this.render(t.getShapeList()):(this.ctx.save(),t.draw(this.ctx),this.ctx.restore())})}}}]);