<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Document</title>
<style>
* {
    padding: 0;
    margin: 0;
}

#container {
    width: 100%;
    height: 500px;
    background-color: #eee;
}
</style>
</head>
<body>
    

<div id="container"></div>
<button id="btn">开始/暂停</button>

<button id="rect">添加矩形</button>
<button id="cir">添加圆形</button>
<button id="tir">添加三角形</button>
<button id="concave">添加凹多边形</button>
<button id="convex">添加凸多边形</button>

<script src="./dist/bundle.js"></script>
<script>

let flag = true;

function getRandomColor() {
    return "rgb(" + Math.round(Math.random() * 255) + "," + Math.round(Math.random() * 255) + ',' + Math.round(Math.random() * 10) + ')';
}


function getRandomPos(width, height) {
    return [Math.floor(Math.random()*width), Math.floor(Math.random()*height)];
}

const World = new P2.World(document.getElementById("container"), {
    gravity: [0, 9],
    linearDrag: [0.25, 0],
    angularDrag: 0.05
}),
    renderer = World.Renderer;


document.getElementById('btn').addEventListener('click', e => {
    flag? World.pause(): World.start();
    flag = !flag;
});

let b1 = new World.body.BoundaryTop({}),
    b2 = new World.body.BoundaryRight({});
    b3 = new World.body.BoundaryBottom({}),
    b4 = new World.body.BoundaryLeft({});


World.append([b1, b2, b3, b4]);



let tri = new World.body.Tri({
    shape: {
        pin: [200, 200],
        edge: 100,
        color: getRandomColor()
    }
});


let rect = new World.body.Rect({
    shape: {
        pin: [260, 187],
        edge: [200, 200],
        color: getRandomColor()
    }
});

World.append([rect, tri]);











World.bind('click', ev => {
    let cir = new World.body.Circle({
        shape: {
            pin: [ev.x, ev.y],
            radius: 16,
            color: getRandomColor()
        }
    });

    World.append(cir);

    let r = new World.body.Rect({
        shape: {
            pin: [ev.x, ev.y],
            edge: [50, 50],
            color: getRandomColor()
        }
    });

    World.append(r);
});





document.getElementById('rect').addEventListener('click', function() {
    let r = new World.body.Rect({
        shape: {
            pin: getRandomPos(World.getWidth(), World.getHeight()),
            edge: [Math.floor(Math.random()*50) + 50, Math.floor(Math.random()*50) + 50],
            color: getRandomColor(),
            fill: false
        }
    });

    World.append(r);
});

document.getElementById('cir').addEventListener('click', function() {
    let c = new World.body.Circle({
        shape: {
            pin: getRandomPos(World.getWidth(), World.getHeight()),
            radius: Math.floor(Math.random()*50) + 10,
            color: getRandomColor(),
            fill: false
        }
    });

    World.append(c);
});

document.getElementById('tir').addEventListener('click', function() {
    let t = new World.body.Tri({
        shape: {
            pin: getRandomPos(World.getWidth(), World.getHeight()),
            edge: Math.floor(Math.random()*50) + 50,
            color: getRandomColor(),
            fill: false
        }
    });

    World.append(t);
});


document.getElementById('concave').addEventListener('click', function() {
    let ca = new World.body.Polygon({
        shape: {
            pin: getRandomPos(World.getWidth(), World.getHeight()),
            vex: [[0, 0], [50, 50], [100, 0], [100, 100], [0, 100], [0, 0]],
            color: getRandomColor()
        }
    });

    World.append(ca);
});

document.getElementById('convex').addEventListener('click', function() {
    let cv = new World.body.Polygon({
        shape: {
            pin: getRandomPos(World.getWidth(), World.getHeight()),
            vex: [[0, 0], [50, -50], [100, 0], [100, 50], [0, 50], [0, 0]],
            color: getRandomColor()
        }
    });

    World.append(cv);
});




World.start();






</script>
</body>
</html>






